---
name: microservice

configs:
  repo:
    volumes:
      msdeps: {}
    services:
      ms:
        build: ../repo
        volumes:
          - 'msdeps:/deps'
      web:
        environment:
          MSKEY: secret
      ms2:
        environment:
          JUST_TO_PROVE: that no "ms" service is created

  remote:
    secrets:
      - varname: MSKEY
        print: [some, thing]
      - exec: [echo, what, ever]
        varname: OTHER_SECRET_TEST
    services:
      web:
        environment:
          MSKEY: $MSKEY
          OTHER_SECRET_TEST:

  registry:
    services:
      ms:
        image: reg:2
      web:
        environment:
          MSKEY: reg

