---
name: microservice

configs:
  repo:
    volumes:
      msdeps: {}
    services:
      ms:
        build: ../repo
        volumes:
          - 'msdeps:/deps'
      web:
        environment:
          MSKEY: secret
      ms2:
        environment:
          JUST_TO_PROVE: that no "ms" service is created

  remote:
    services:
      web:
        environment:
          MSKEY: remote

  registry:
    services:
      ms:
        image: reg:2
      web:
        environment:
          MSKEY: reg

